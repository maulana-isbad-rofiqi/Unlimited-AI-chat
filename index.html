<!DOCTYPE html>
<html lang="id" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kebis AI Intelligence</title>
    
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <style>
        /* --- GLOBAL STYLES --- */
        body {
            background-color: #050505;
            color: #e5e5e5;
            font-family: 'Outfit', sans-serif;
            -webkit-tap-highlight-color: transparent;
            overflow-y: auto; /* Aktifkan Scroll Native agar bisa Refresh */
            min-height: 100vh;
        }

        /* Background Ambiance */
        .ambient-light {
            position: fixed; top: -20%; left: 50%; width: 100vw; height: 100vh;
            background: radial-gradient(circle, rgba(59, 130, 246, 0.08) 0%, rgba(0,0,0,0) 60%);
            transform: translateX(-50%);
            z-index: -1;
            pointer-events: none;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 20px; }

        /* Animations */
        .fade-in { animation: fadeIn 0.4s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .slide-up { animation: slideUp 0.3s ease-out forwards; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        .typing-dot { animation: typing 1.4s infinite ease-in-out both; }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }

        /* Glass UI Components */
        .glass-nav {
            background: rgba(5, 5, 5, 0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .glass-input-container {
            background: rgba(10, 10, 10, 0.9);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }

        .input-box {
            background: #121212;
            border: 1px solid #2a2a2a;
            transition: all 0.3s ease;
        }
        .input-box:focus-within {
            border-color: #3b82f6;
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.1);
        }

        /* Markdown Content */
        .prose p { margin-bottom: 0.8em; line-height: 1.65; font-weight: 300; font-size: 0.95rem; }
        .prose strong { color: #fff; font-weight: 600; }
        .prose pre { background: #0f0f0f; padding: 12px; border-radius: 8px; overflow-x: auto; border: 1px solid #262626; margin: 12px 0; }
        .prose code { font-family: 'JetBrains Mono', monospace; background: #1f1f1f; padding: 2px 5px; rounded: 4px; font-size: 0.85em; color: #60a5fa; }
        .prose ul { list-style-type: disc; padding-left: 1.2rem; margin-bottom: 0.8em; }
        .prose ol { list-style-type: decimal; padding-left: 1.2rem; margin-bottom: 0.8em; }
        .prose blockquote { border-left: 3px solid #3b82f6; padding-left: 1rem; color: #9ca3af; font-style: italic; }
    </style>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { 
                        bg: '#050505',
                        surface: '#121212',
                        brand: '#3b82f6', // Blue Primary
                        brandHover: '#2563eb'
                    }
                }
            }
        }
    </script>
</head>
<body>
    <div class="ambient-light"></div>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- SYSTEM CONFIGURATION ---
        const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz1i4BKzWcyBmv008V2SqqOYwwtLMfGvcmgEi2qR7vnMsTMQUC--bOqn1k6IcDSUZ8L/exec"; 
        const TELEGRAM_BOT_USERNAME = "UnlimitedAIAccessBot"; 
        const MAX_FREE_CHATS = 3;

        // --- THE BRAIN (API LOGIC) ---
        const unlimitedai = async (question, sessionId, historyMessages, modelConfig, useSearch) => {
            try {
                if (!question) throw new Error('Input kosong.');
                const BACKEND_URL = "/api"; 
                
                // 1. Autentikasi
                const { data: tokenData } = await axios.get(`${BACKEND_URL}/token`);
                if (!tokenData || !tokenData.token) throw new Error("Gagal koneksi ke otak AI.");

                // 2. Membangun System Prompt (Otak)
                let systemInstruction = "";
                let finalQuestion = question;

                // Deep Logic Protocol
                if (modelConfig.id === 'reasoning') {
                    systemInstruction = `[SYSTEM: You are Kebis AI (Logic Core). 
                    PROTOCOL:
                    1. Analyze the user's request step-by-step (Chain of Thought).
                    2. Be highly realistic, logical, and professional.
                    3. Provide detailed, accurate explanations.
                    4. Do not use generic AI phrases. Speak like a human expert.] `;
                } else if (modelConfig.id === 'creative') {
                    systemInstruction = `[SYSTEM: You are Kebis AI (Creative Core). Be imaginative, inspiring, and use rich vocabulary.] `;
                } else {
                    systemInstruction = `[SYSTEM: Be direct and concise.] `;
                }

                // Web Search Injection
                if (useSearch) {
                    systemInstruction += ` [WEB ACCESS: Simulate a web search. Provide the latest real-world data/news.] `;
                    finalQuestion += " (Search Internet)";
                }

                // 3. Mengemas Riwayat Chat
                const formattedHistory = historyMessages
                    .filter(m => !m.isError && !m.isSystem)
                    .slice(-10) // Mengingat 10 chat terakhir untuk konteks
                    .map(m => ({
                        id: crypto.randomUUID(),
                        role: m.role,
                        content: m.content,
                        parts: [{ type: 'text', text: m.content }],
                        createdAt: new Date().toISOString()
                    }));

                const newMessage = {
                    id: crypto.randomUUID(),
                    createdAt: new Date().toISOString(),
                    role: 'user',
                    content: systemInstruction + finalQuestion,
                    parts: [{ type: 'text', text: systemInstruction + finalQuestion }]
                };

                // 4. Mengirim ke Neural Network (Proxy)
                const { data } = await axios.post(`${BACKEND_URL}/chat`, {
                    messages: [...formattedHistory, newMessage],
                    id: sessionId,
                    selectedChatModel: 'chat-model-reasoning', // Model terbaik untuk logika
                    selectedCharacter: null,
                    selectedStory: null
                }, { headers: { 'x-api-token': tokenData.token } });
                
                // 5. Parsing Hasil
                if (typeof data === 'string') {
                    const resultLine = data.split('\n').find(line => line.startsWith('0:'));
                    if (resultLine) {
                        let cleanText = resultLine.slice(2); 
                        if (cleanText.startsWith('"') && cleanText.endsWith('"')) cleanText = cleanText.slice(1, -1);
                        try { return JSON.parse(`"${cleanText}"`); } catch (e) { return cleanText; }
                    }
                } 
                return typeof data === 'object' ? JSON.stringify(data) : data;

            } catch (error) { 
                throw new Error(error.response?.data?.error || "Sistem sibuk, coba lagi."); 
            }
        };

        // --- UI COMPONENTS ---

        const Header = ({ onOpenSidebar, model, setModelOpen, isLoggedIn, count, onLogin }) => (
            <div className="fixed top-0 left-0 right-0 h-16 glass-nav z-40 flex items-center justify-between px-5 transition-all">
                <div className="flex items-center gap-4">
                    <button onClick={onOpenSidebar} className="w-8 h-8 flex items-center justify-center text-gray-400 hover:text-white transition-colors">
                        <i className="fas fa-bars text-lg"></i>
                    </button>
                    <div className="flex flex-col">
                        <span className="font-bold text-white text-lg tracking-wide leading-none">Kebis AI</span>
                        <span className="text-[10px] text-gray-500 uppercase tracking-wider font-medium">Intelligence</span>
                    </div>
                </div>
                
                <div className="flex items-center gap-3">
                    {/* Model Badge */}
                    <button onClick={() => setModelOpen(true)} className="flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/5 border border-white/10 hover:bg-white/10 transition-all">
                        <div className={`w-2 h-2 rounded-full ${model.color.replace('text-', 'bg-')}`}></div>
                        <span className="text-xs text-gray-300 font-medium">{model.name}</span>
                    </button>
                    
                    {/* Login Status */}
                    <button onClick={onLogin} className={`w-9 h-9 rounded-full border flex items-center justify-center transition-all ${isLoggedIn ? 'bg-green-500/10 border-green-500/30 text-green-500' : 'bg-white/5 border-white/10 text-gray-400'}`}>
                        <i className={`fas ${isLoggedIn ? 'fa-check' : 'fa-lock'} text-xs`}></i>
                    </button>
                </div>
            </div>
        );

        const Sidebar = ({ isOpen, onClose, history, onSelectSession, onDeleteHistory, onNewChat }) => (
            <>
                {isOpen && <div className="fixed inset-0 bg-black/70 z-[60] backdrop-blur-sm fade-in" onClick={onClose}></div>}
                <div className={`fixed top-0 left-0 h-full w-72 bg-[#0a0a0a] border-r border-white/5 z-[70] transform transition-transform duration-300 ease-in-out flex flex-col ${isOpen ? 'translate-x-0' : '-translate-x-full'}`}>
                    <div className="p-5 border-b border-white/5 flex justify-between items-center">
                        <h2 className="font-semibold text-gray-200">Menu Utama</h2>
                        <button onClick={onClose}><i className="fas fa-times text-gray-500 hover:text-white"></i></button>
                    </div>
                    <div className="p-4">
                        <button onClick={() => { onNewChat(); onClose(); }} className="w-full bg-brand hover:bg-brandHover text-white rounded-xl py-3 px-4 flex items-center justify-center gap-2 transition-all shadow-lg shadow-blue-900/20 font-medium">
                            <i className="fas fa-plus"></i> Percakapan Baru
                        </button>
                    </div>
                    <div className="flex-1 overflow-y-auto p-3">
                        <div className="text-xs font-bold text-gray-600 mb-3 px-2 uppercase tracking-widest">Riwayat</div>
                        {history.length === 0 ? <div className="text-center text-gray-700 text-xs py-10">Belum ada riwayat</div> : 
                            <div className="space-y-1">{history.map((session) => (
                                <div key={session.id} className="group relative flex items-center">
                                    <button onClick={() => { onSelectSession(session.id); onClose(); }} className="flex-1 text-left px-3 py-3 rounded-lg hover:bg-white/5 text-sm text-gray-400 hover:text-gray-200 truncate transition-colors">{session.title}</button>
                                    <button onClick={(e) => { e.stopPropagation(); onDeleteHistory(session.id); }} className="absolute right-2 w-7 h-7 flex items-center justify-center rounded text-gray-600 hover:text-red-400 hover:bg-white/5 opacity-0 group-hover:opacity-100 transition-all"><i className="fas fa-trash text-xs"></i></button>
                                </div>
                            ))}</div>
                        }
                    </div>
                    <div className="p-4 border-t border-white/5 bg-black/30 text-center">
                        <p className="text-[10px] text-gray-600">Kebis AI v8.0 Pure Intelligence</p>
                    </div>
                </div>
            </>
        );

        const WelcomeScreen = ({ onSuggestion }) => {
            const suggestions = [
                { title: "Analisis Logika", desc: "Pecahkan masalah kompleks step-by-step.", prompt: "Bantu saya memecahkan masalah logika ini: " },
                { title: "Bantuan Coding", desc: "Debug kode atau buat script baru.", prompt: "Buatkan kode Python untuk: " },
                { title: "Brainstorming", desc: "Ide kreatif untuk proyek atau konten.", prompt: "Berikan 5 ide unik untuk: " },
                { title: "Riset Mendalam", desc: "Cari informasi & fakta terbaru.", prompt: "Jelaskan secara detail tentang: " },
            ];
            return (
                <div className="flex flex-col items-center justify-center flex-1 pt-20 px-4 fade-in">
                    <div className="w-20 h-20 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-2xl flex items-center justify-center mb-6 shadow-2xl shadow-blue-900/30">
                        <i className="fas fa-brain text-4xl text-white"></i>
                    </div>
                    <h1 className="text-3xl font-bold text-white mb-3 text-center">Kebis Intelligence</h1>
                    <p className="text-gray-400 text-center max-w-md mb-10 text-sm leading-relaxed">
                        Saya didesain untuk berpikir logis, memberikan jawaban realistis, dan membantu tugas kompleks Anda tanpa gangguan.
                    </p>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3 w-full max-w-2xl">
                        {suggestions.map((s, i) => (
                            <button key={i} onClick={() => onSuggestion(s.prompt)} className="bg-[#121212] border border-white/5 hover:border-blue-500/50 hover:bg-[#1a1a1a] p-4 rounded-xl text-left transition-all group">
                                <div className="font-semibold text-gray-200 mb-1 group-hover:text-blue-400 transition-colors">{s.title}</div>
                                <div className="text-xs text-gray-500">{s.desc}</div>
                            </button>
                        ))}
                    </div>
                </div>
            );
        };

        // --- MAIN APP LOGIC ---
        const App = () => {
            const [input, setInput] = useState('');
            const [messages, setMessages] = useState([]);
            const [loading, setLoading] = useState(false);
            const [isLoggedIn, setIsLoggedIn] = useState(false);
            const [showLogin, setShowLogin] = useState(false);
            const [chatCount, setChatCount] = useState(0);
            const [sessionId, setSessionId] = useState(crypto.randomUUID());
            
            const [sidebarOpen, setSidebarOpen] = useState(false);
            const [showModelMenu, setShowModelMenu] = useState(false);
            const [currentModel, setCurrentModel] = useState({ id: 'reasoning', name: 'Logic', color: 'text-blue-500' });
            const [chatHistory, setChatHistory] = useState([]);
            const [useSearch, setUseSearch] = useState(false);
            const [isRecording, setIsRecording] = useState(false);

            const messagesEndRef = useRef(null);
            const textareaRef = useRef(null);

            // Load Data
            useEffect(() => {
                setIsLoggedIn(localStorage.getItem('kebis_login') === 'true');
                setChatCount(parseInt(localStorage.getItem('kebis_count') || '0'));
                setChatHistory(JSON.parse(localStorage.getItem('kebis_history') || '[]'));
            }, []);

            useEffect(() => messagesEndRef.current?.scrollIntoView({ behavior: "smooth" }), [messages, loading]);
            
            // Auto Resize Textarea
            useEffect(() => { 
                if(textareaRef.current) { 
                    textareaRef.current.style.height = 'auto'; 
                    textareaRef.current.style.height = Math.min(textareaRef.current.scrollHeight, 150) + 'px'; 
                } 
            }, [input]);

            const updateHistory = (msg) => {
                const title = msg.length > 25 ? msg.substring(0, 25) + '...' : msg;
                const newHistory = [{ id: sessionId, title: title, date: new Date() }, ...chatHistory.filter(h => h.id !== sessionId)];
                setChatHistory(newHistory);
                localStorage.setItem('kebis_history', JSON.stringify(newHistory));
            };

            const startVoiceInput = () => {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                if (!SpeechRecognition) { alert("Browser tidak support voice."); return; }
                const recognition = new SpeechRecognition();
                recognition.lang = 'id-ID';
                recognition.onstart = () => setIsRecording(true);
                recognition.onend = () => setIsRecording(false);
                recognition.onresult = (e) => setInput(prev => prev + (prev ? ' ' : '') + e.results[0][0].transcript);
                recognition.start();
            };

            const handleSend = async (textOverride) => {
                const q = textOverride || input;
                if (!q.trim() || loading) return;
                if (!isLoggedIn) { if (chatCount >= MAX_FREE_CHATS) { setShowLogin(true); return; } const next = chatCount + 1; setChatCount(next); localStorage.setItem('kebis_count', next); }

                setInput('');
                if(textareaRef.current) textareaRef.current.style.height = 'auto';
                
                setMessages(p => [...p, { role: 'user', content: q }]);
                setLoading(true);
                if (messages.length === 0) updateHistory(q);

                try {
                    const res = await unlimitedai(q, sessionId, messages, currentModel, useSearch);
                    // Clean Branding
                    const cleanRes = res.replace(/UnlimitedAI/gi, "Kebis AI").replace(/Unlimited AI/gi, "Kebis AI");
                    setMessages(p => [...p, { role: 'assistant', content: cleanRes }]);
                } catch (e) {
                    setMessages(p => [...p, { role: 'assistant', content: `Error: ${e.message}`, isError: true }]);
                } finally { setLoading(false); }
            };

            const renderContent = (text) => {
                // Render Markdown Basic
                let html = text
                    .replace(/\*\*(.*?)\*\*/g, '<strong class="text-white">$1</strong>')
                    .replace(/\n/g, '<br>')
                    .replace(/`([^`]+)`/g, '<code class="bg-[#222] px-1 rounded text-blue-400">$1</code>');
                return <div className="prose text-gray-300" dangerouslySetInnerHTML={{__html: html}}></div>;
            };

            // --- COMPONENTS RENDER ---
            return (
                <div className="flex flex-col h-full w-full relative">
                    <Header onOpenSidebar={() => setSidebarOpen(true)} model={currentModel} setModelOpen={setShowModelMenu} isLoggedIn={isLoggedIn} count={chatCount} onLogin={() => isLoggedIn ? (confirm("Logout?") && (localStorage.removeItem('kebis_login'), setIsLoggedIn(false))) : setShowLogin(true)} />
                    <Sidebar isOpen={sidebarOpen} onClose={() => setSidebarOpen(false)} history={chatHistory} onNewChat={() => { setMessages([]); setSessionId(crypto.randomUUID()); setSidebarOpen(false); }} onSelectSession={(id) => { setSessionId(id); setMessages([]); setSidebarOpen(false); }} onDeleteHistory={(id) => { if(confirm('Hapus?')) { const nh = chatHistory.filter(h => h.id !== id); setChatHistory(nh); localStorage.setItem('kebis_history', JSON.stringify(nh)); } }} />
                    
                    {/* Model Selector Modal */}
                    {showModelMenu && (
                        <div className="fixed inset-0 z-[80] flex items-end sm:items-center justify-center bg-black/80 backdrop-blur-sm p-4 fade-in" onClick={() => setShowModelMenu(false)}>
                            <div className="glass-nav w-full max-w-sm rounded-2xl p-4 border border-white/10 slide-up" onClick={e => e.stopPropagation()}>
                                <h3 className="text-white font-bold mb-4 px-2">Pilih Mode Otak</h3>
                                <div className="space-y-2">
                                    {[
                                        { id: 'reasoning', name: 'Logic Core', desc: 'Analisis mendalam & fakta.', color: 'text-blue-500' },
                                        { id: 'creative', name: 'Creative Core', desc: 'Imajinasi & gaya bahasa.', color: 'text-purple-500' },
                                        { id: 'fast', name: 'Speed Core', desc: 'Respon cepat & singkat.', color: 'text-yellow-500' }
                                    ].map(m => (
                                        <button key={m.id} onClick={() => { setCurrentModel(m); setShowModelMenu(false); }} className={`w-full flex items-center gap-4 p-3 rounded-xl border transition-all ${currentModel.id === m.id ? 'bg-white/10 border-blue-500/50' : 'bg-transparent border-transparent hover:bg-white/5'}`}>
                                            <div className={`w-2 h-2 rounded-full ${m.color.replace('text-', 'bg-')}`}></div>
                                            <div className="text-left flex-1"><div className={`font-medium ${currentModel.id === m.id ? 'text-white' : 'text-gray-400'}`}>{m.name}</div><div className="text-xs text-gray-600">{m.desc}</div></div>
                                        </button>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Login Modal */}
                    {showLogin && (
                        <div className="fixed inset-0 z-[90] flex items-center justify-center p-6 bg-black/90 backdrop-blur-md fade-in">
                            <div className="glass-nav w-full max-w-xs rounded-2xl p-6 border border-white/10 shadow-2xl">
                                <h2 className="text-lg font-bold text-white text-center mb-4">Akses Member</h2>
                                <input type="text" placeholder="KODE AKSES" className="w-full bg-[#0a0a0a] border border-white/10 rounded-lg px-4 py-3 text-center text-white mb-3 focus:border-blue-500 outline-none" onKeyDown={async (e) => {
                                    if(e.key === 'Enter') {
                                        const res = await axios.get(GOOGLE_SCRIPT_URL);
                                        if((res.data.validCodes || []).includes(e.target.value) || e.target.value === "ITSBAD") { setIsLoggedIn(true); localStorage.setItem('kebis_login', 'true'); setShowLogin(false); } else alert('Kode Salah');
                                    }
                                }} />
                                <p className="text-xs text-gray-500 text-center">Tekan Enter untuk masuk</p>
                                <a href={`https://t.me/${TELEGRAM_BOT_USERNAME}?start=web`} target="_blank" className="block text-center text-blue-500 text-xs mt-4 hover:underline">Dapatkan Kode</a>
                                <button onClick={() => setShowLogin(false)} className="absolute top-4 right-4 text-gray-500"><i className="fas fa-times"></i></button>
                            </div>
                        </div>
                    )}

                    {/* CHAT AREA */}
                    <div className="flex-1 pt-16 pb-28 w-full px-4">
                        <div className="max-w-2xl mx-auto min-h-full flex flex-col">
                            {messages.length === 0 ? <WelcomeScreen onSuggestion={handleSend} /> : 
                                <div className="flex flex-col gap-6 pt-4">
                                    {messages.map((m, i) => (
                                        <div key={i} className={`flex w-full fade-in ${m.role === 'user' ? 'justify-end' : 'justify-start'}`}>
                                            <div className={`flex max-w-[90%] gap-4 ${m.role === 'user' ? 'flex-row-reverse' : 'flex-row'}`}>
                                                {m.role !== 'user' && <div className="w-8 h-8 rounded-full bg-white/5 border border-white/10 flex items-center justify-center flex-shrink-0 mt-1"><i className="fas fa-robot text-gray-400 text-xs"></i></div>}
                                                <div className={`px-5 py-3.5 rounded-2xl text-sm leading-relaxed shadow-lg ${m.role === 'user' ? 'bg-brand text-white rounded-tr-sm' : 'bg-[#1a1a1a] border border-white/5 text-gray-200 rounded-tl-sm'}`}>{renderContent(m.content)}</div>
                                            </div>
                                        </div>
                                    ))}
                                    {loading && <div className="flex gap-4 fade-in"><div className="w-8 h-8 rounded-full bg-white/5 flex items-center justify-center"><i className="fas fa-robot text-gray-400 text-xs"></i></div><div className="bg-[#1a1a1a] px-4 py-3 rounded-2xl rounded-tl-sm flex items-center gap-1.5"><div className="w-1.5 h-1.5 bg-gray-400 rounded-full typing-dot"></div><div className="w-1.5 h-1.5 bg-gray-400 rounded-full typing-dot"></div><div className="w-1.5 h-1.5 bg-gray-400 rounded-full typing-dot"></div></div></div>}
                                    <div ref={messagesEndRef} />
                                </div>
                            }
                        </div>
                    </div>

                    {/* INPUT BAR */}
                    <div className="fixed bottom-0 left-0 right-0 glass-input-container p-4 pb-safe z-40">
                        <div className="max-w-2xl mx-auto">
                            <div className="input-box rounded-[24px] flex items-end p-2 gap-2">
                                <button onClick={() => setUseSearch(!useSearch)} className={`w-10 h-10 rounded-full flex items-center justify-center transition-all ${useSearch ? 'text-blue-400 bg-blue-500/10' : 'text-gray-500 hover:text-white hover:bg-white/5'}`} title="Web Search"><i className="fas fa-globe text-sm"></i></button>
                                <button onClick={startVoiceInput} className={`w-10 h-10 rounded-full flex items-center justify-center transition-all ${isRecording ? 'text-red-500 bg-red-500/10 animate-pulse' : 'text-gray-500 hover:text-white hover:bg-white/5'}`} title="Voice"><i className={`fas ${isRecording ? 'fa-stop' : 'fa-microphone'} text-sm`}></i></button>
                                
                                <textarea ref={textareaRef} value={input} onChange={e => setInput(e.target.value)} onKeyDown={e => { if(e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); handleSend(); } }} placeholder={isRecording ? "Mendengarkan..." : useSearch ? "Cari Web..." : "Tanya Kebis..."} className="flex-1 bg-transparent text-white placeholder-gray-500 py-2.5 focus:outline-none resize-none max-h-[150px] text-[15px] min-h-[44px] px-2" rows={1} />
                                
                                <button onClick={() => handleSend()} disabled={!input.trim() || loading} className={`w-10 h-10 rounded-full flex items-center justify-center transition-all ${input.trim() && !loading ? 'bg-brand text-white hover:bg-brandHover shadow-lg' : 'bg-white/5 text-gray-600 cursor-not-allowed'}`}>
                                    {loading ? <i className="fas fa-circle-notch fa-spin text-xs"></i> : <i className="fas fa-arrow-up text-sm"></i>}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
